(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6578],{716:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},1319:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},2330:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},3277:(e,t,s)=>{Promise.resolve().then(s.bind(s,5011))},3947:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},5011:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(8307),r=s(3603),l=s(5384),d=s(8743),n=s(1319),i=s(9418),c=s(6353),o=s(716),m=s(2330),x=s(3947),u=s(5803),h=s.n(u),p=s(8061);function g(){var e,t;let{get:s}=(0,p.g)(),[u,g]=(0,r.useState)({userId:"",entity:"",action:""}),{data:y,isLoading:f,refetch:b,isFetching:j}=(0,l.I)({queryKey:["admin-audit",u],queryFn:()=>{let e=new URLSearchParams;return e.set("limit","100"),u.userId&&e.set("userId",u.userId),u.entity&&e.set("entity",u.entity),u.action&&e.set("action",u.action),s("/api/v1/admin/audit?".concat(e))}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(h(),{href:"/admin",className:"p-2 hover:bg-accent rounded-md transition-colors",children:(0,a.jsx)(d.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-semibold tracking-tight flex items-center gap-2",children:[(0,a.jsx)(n.A,{className:"h-6 w-6"}),"Audit Logs"]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Hist\xf3rico de a\xe7\xf5es e altera\xe7\xf5es no sistema"})]})]}),(0,a.jsxs)("button",{onClick:()=>b(),disabled:j,className:"inline-flex items-center justify-center rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent disabled:opacity-50",children:[(0,a.jsx)(i.A,{className:"mr-2 h-4 w-4 ".concat(j?"animate-spin":"")}),"Atualizar"]})]}),(0,a.jsx)("div",{className:"rounded-lg border bg-card p-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,a.jsxs)("label",{className:"text-sm font-medium mb-1 block",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 inline mr-1"}),"User ID"]}),(0,a.jsx)("input",{type:"text",placeholder:"Filtrar por usu\xe1rio...",value:u.userId,onChange:e=>g({...u,userId:e.target.value}),className:"h-9 w-full rounded-md border border-input bg-background px-3 text-sm"})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,a.jsxs)("label",{className:"text-sm font-medium mb-1 block",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 inline mr-1"}),"Entidade"]}),(0,a.jsx)("input",{type:"text",placeholder:"Filtrar por entidade...",value:u.entity,onChange:e=>g({...u,entity:e.target.value}),className:"h-9 w-full rounded-md border border-input bg-background px-3 text-sm"})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,a.jsxs)("label",{className:"text-sm font-medium mb-1 block",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 inline mr-1"}),"A\xe7\xe3o"]}),(0,a.jsx)("input",{type:"text",placeholder:"Filtrar por a\xe7\xe3o...",value:u.action,onChange:e=>g({...u,action:e.target.value}),className:"h-9 w-full rounded-md border border-input bg-background px-3 text-sm"})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:()=>g({userId:"",entity:"",action:""}),className:"h-9 px-4 rounded-md border text-sm hover:bg-accent",children:"Limpar"})})]})}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card",children:[(0,a.jsx)("div",{className:"border-b px-4 py-3",children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(null==y?void 0:y.total)||0," registros encontrados"]})}),f?(0,a.jsx)("div",{className:"p-8 flex justify-center",children:(0,a.jsx)(i.A,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(null==y||null==(e=y.logs)?void 0:e.length)===0?(0,a.jsxs)("div",{className:"p-8 text-center text-muted-foreground",children:[(0,a.jsx)(n.A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{children:"Nenhum registro de auditoria encontrado"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"border-b bg-muted/50",children:(0,a.jsxs)("tr",{children:[(0,a.jsxs)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 inline mr-1"}),"Data/Hora"]}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Usu\xe1rio"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"A\xe7\xe3o"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Entidade"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"ID"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Altera\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:null==y||null==(t=y.logs)?void 0:t.map(e=>{var t,s;return(0,a.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:new Date(e.timestamp).toLocaleString("pt-BR")}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm font-mono text-xs",children:[e.userId.substring(0,8),"..."]}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("span",{className:"inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ".concat((s=e.action).includes("create")||s.includes("CREATE")?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":s.includes("update")||s.includes("UPDATE")?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":s.includes("delete")||s.includes("DELETE")?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400"),children:e.action})}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm",children:e.entity}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm font-mono text-xs",children:[null==(t=e.entityId)?void 0:t.substring(0,8),"..."]}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.changes?(0,a.jsxs)("details",{children:[(0,a.jsx)("summary",{className:"text-xs text-muted-foreground cursor-pointer",children:"Ver altera\xe7\xf5es"}),(0,a.jsx)("pre",{className:"mt-1 text-xs bg-muted p-2 rounded max-w-xs overflow-x-auto",children:JSON.stringify(e.changes,null,2)})]}):(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"-"})})]},e.id)})})]})})]})]})}},6353:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},8061:(e,t,s)=>{"use strict";s.d(t,{g:()=>l});var a=s(3603);let r="trackpro_auth";function l(){let e=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=function(){let e=localStorage.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(),a={"Content-Type":"application/json",...t.headers};s&&(a.Authorization="Bearer ".concat(s.accessToken));let l=await fetch("".concat("http://localhost:3001").concat(e),{...t,headers:a});if(!l.ok){let e=await l.json().catch(()=>({}));throw 401===l.status&&(localStorage.removeItem(r),window.location.pathname.includes("/login")||(window.location.href="/login")),Error(e.message||"Request failed: ".concat(l.status))}return 204===l.status?{}:l.json()},[]),t=(0,a.useCallback)(t=>e(t,{method:"GET"}),[e]),s=(0,a.useCallback)((t,s)=>e(t,{method:"POST",body:s?JSON.stringify(s):void 0}),[e]),l=(0,a.useCallback)((t,s)=>e(t,{method:"PUT",body:s?JSON.stringify(s):void 0}),[e]),d=(0,a.useCallback)((t,s)=>e(t,{method:"DELETE",body:s?JSON.stringify(s):void 0}),[e]);return{request:e,get:t,post:s,put:l,del:d}}},8743:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9418:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[5803,2198,528,6438,2453,7358],()=>e(e.s=3277)),_N_E=e.O()}]);