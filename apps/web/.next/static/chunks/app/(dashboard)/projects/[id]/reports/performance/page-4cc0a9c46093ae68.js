(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5388],{287:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(3161).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1319:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(3161).A)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},3947:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(3161).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},4427:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(3161).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},4844:(e,t,s)=>{"use strict";var r=s(5340);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},5155:(e,t,s)=>{Promise.resolve().then(s.bind(s,8375))},7911:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(3161).A)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},8061:(e,t,s)=>{"use strict";s.d(t,{g:()=>n});var r=s(3603);let a="trackpro_auth";function n(){let e=(0,r.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=function(){let e=localStorage.getItem(a);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(),r={"Content-Type":"application/json",...t.headers};s&&(r.Authorization="Bearer ".concat(s.accessToken));let n=await fetch("".concat("http://localhost:3001").concat(e),{...t,headers:r});if(!n.ok){let e=await n.json().catch(()=>({}));throw 401===n.status&&(localStorage.removeItem(a),window.location.pathname.includes("/login")||(window.location.href="/login")),Error(e.message||"Request failed: ".concat(n.status))}return 204===n.status?{}:n.json()},[]),t=(0,r.useCallback)(t=>e(t,{method:"GET"}),[e]),s=(0,r.useCallback)((t,s)=>e(t,{method:"POST",body:s?JSON.stringify(s):void 0}),[e]),n=(0,r.useCallback)((t,s)=>e(t,{method:"PUT",body:s?JSON.stringify(s):void 0}),[e]),d=(0,r.useCallback)((t,s)=>e(t,{method:"DELETE",body:s?JSON.stringify(s):void 0}),[e]);return{request:e,get:t,post:s,put:n,del:d}}},8375:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var r=s(8307),a=s(3603),n=s(4844),d=s(5384),c=s(8743),l=s(9418),i=s(7911),o=s(1319),m=s(4427),x=s(287),u=s(3947),h=s(3161);let p=(0,h.A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),g=(0,h.A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);var y=s(9019),f=s(5803),j=s.n(f),v=s(8061);function N(){var e,t,s,h,f,N,b;let k=(0,n.useParams)().id,{get:w}=(0,v.g)(),[A,S]=(0,a.useState)(()=>{let e=new Date;return e.setDate(e.getDate()-30),e.toISOString().split("T")[0]}),[C,M]=(0,a.useState)(()=>new Date().toISOString().split("T")[0]),[P,T]=(0,a.useState)("source"),{data:R}=(0,d.I)({queryKey:["tenants"],queryFn:()=>w("/api/v1/tenants")}),O=null==R||null==(e=R[0])?void 0:e.id,{data:E,isLoading:q,refetch:F,isFetching:D}=(0,d.I)({queryKey:["performance-report",O,k,A,C],queryFn:()=>w("/api/v1/tenants/".concat(O,"/projects/").concat(k,"/reports/performance?startDate=").concat(A,"&endDate=").concat(C)),enabled:!!O}),L=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),z=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toLocaleString("pt-BR");return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(j(),{href:"/projects/".concat(k),className:"p-2 hover:bg-accent rounded-md transition-colors",children:(0,r.jsx)(c.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:"Performance"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"An\xe1lise de performance por fonte de tr\xe1fego"})]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)("button",{onClick:()=>F(),disabled:D,className:"inline-flex items-center justify-center rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent disabled:opacity-50",children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4 ".concat(D?"animate-spin":"")}),"Atualizar"]})})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)(j(),{href:"/projects/".concat(k,"/reports"),className:"inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent",children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),"Vis\xe3o Geral"]}),(0,r.jsxs)(j(),{href:"/projects/".concat(k,"/reports/funnel"),className:"inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),"Funil"]}),(0,r.jsxs)(j(),{href:"/projects/".concat(k,"/reports/performance"),className:"inline-flex items-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground",children:[(0,r.jsx)(m.A,{className:"h-4 w-4"}),"Performance"]}),(0,r.jsxs)(j(),{href:"/projects/".concat(k,"/reports/quality"),className:"inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent",children:[(0,r.jsx)(x.A,{className:"h-4 w-4"}),"Qualidade"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 rounded-lg border bg-card p-4",children:[(0,r.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"date",value:A,onChange:e=>S(e.target.value),className:"h-9 rounded-md border border-input bg-background px-3 py-1 text-sm"}),(0,r.jsx)("span",{className:"text-muted-foreground",children:"at\xe9"}),(0,r.jsx)("input",{type:"date",value:C,onChange:e=>M(e.target.value),className:"h-9 rounded-md border border-input bg-background px-3 py-1 text-sm"})]})]}),q?(0,r.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,r.jsx)(l.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,r.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"Carregando performance..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,r.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Receita Total"}),(0,r.jsx)(p,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)("p",{className:"mt-2 text-2xl font-semibold text-green-600",children:L((null==E?void 0:E.totalRevenue)||0)})]}),(0,r.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total de Pedidos"}),(0,r.jsx)(g,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)("p",{className:"mt-2 text-2xl font-semibold",children:((null==E?void 0:E.totalOrders)||0).toLocaleString("pt-BR")})]}),(0,r.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Ticket M\xe9dio"}),(0,r.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)("p",{className:"mt-2 text-2xl font-semibold",children:L((null==E?void 0:E.averageOrderValue)||0)})]})]}),(0,r.jsxs)("div",{className:"rounded-lg border bg-card",children:[(0,r.jsx)("div",{className:"border-b px-4",children:(0,r.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"source",label:"Por Fonte"},{id:"medium",label:"Por Meio"},{id:"campaign",label:"Por Campanha"}].map(e=>(0,r.jsx)("button",{onClick:()=>T(e.id),className:"py-4 px-1 text-sm font-medium border-b-2 transition-colors ".concat(P===e.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),children:e.label},e.id))})}),(0,r.jsxs)("div",{className:"overflow-x-auto",children:[(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"border-b bg-muted/50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"source"===P?"Fonte":"medium"===P?"Meio":"Campanha"}),(0,r.jsx)("th",{className:"px-4 py-3 text-right text-sm font-medium text-muted-foreground",children:"Eventos"}),(0,r.jsx)("th",{className:"px-4 py-3 text-right text-sm font-medium text-muted-foreground",children:"Usu\xe1rios"}),"source"===P&&(0,r.jsx)("th",{className:"px-4 py-3 text-right text-sm font-medium text-muted-foreground",children:"Sess\xf5es"}),(0,r.jsx)("th",{className:"px-4 py-3 text-right text-sm font-medium text-muted-foreground",children:"Receita"})]})}),(0,r.jsxs)("tbody",{className:"divide-y",children:["source"===P&&(null==E||null==(t=E.bySource)?void 0:t.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-medium",children:e.source||"(direct)"}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right",children:z(e.events)}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right",children:z(e.users)}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right",children:z(e.sessions)}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right font-medium text-green-600",children:L(e.revenue)})]},e.source))),"medium"===P&&(null==E||null==(s=E.byMedium)?void 0:s.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-medium",children:e.medium||"(none)"}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right",children:z(e.events)}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right",children:z(e.users)}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right font-medium text-green-600",children:L(e.revenue)})]},e.medium))),"campaign"===P&&(null==E||null==(h=E.byCampaign)?void 0:h.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-medium",children:e.campaign||"(none)"}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right",children:z(e.events)}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right",children:z(e.users)}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-right font-medium text-green-600",children:L(e.revenue)})]},e.campaign)))]})]}),("source"===P&&!(null==E||null==(f=E.bySource)?void 0:f.length)||"medium"===P&&!(null==E||null==(N=E.byMedium)?void 0:N.length)||"campaign"===P&&!(null==E||null==(b=E.byCampaign)?void 0:b.length))&&(0,r.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"Nenhum dado dispon\xedvel para este per\xedodo"})]})]})]})]})}},8743:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(3161).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9019:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(3161).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},9418:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(3161).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[5803,2198,528,6438,2453,7358],()=>e(e.s=5155)),_N_E=e.O()}]);