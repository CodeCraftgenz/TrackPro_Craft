(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4899],{507:(e,t,s)=>{Promise.resolve().then(s.bind(s,4760))},716:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},1319:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},2330:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},3933:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},4760:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(8307),i=s(3603),r=s(4844),n=s(5384),l=s(8743),o=s(9418),d=s(2330),c=s(716),u=s(1319),h=s(3933),m=s(9374),x=s(5803),p=s.n(x),v=s(8061);let w={page_view:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",purchase:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",lead:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",add_to_cart:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400",view_content:"bg-cyan-100 text-cyan-700 dark:bg-cyan-900/30 dark:text-cyan-400",initiate_checkout:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"};function g(){var e,t;let s=(0,r.useParams)().id,{get:x}=(0,v.g)(),[g,b]=(0,i.useState)(0),[f,j]=(0,i.useState)(""),[y,N]=(0,i.useState)(""),{data:k}=(0,n.I)({queryKey:["tenants"],queryFn:()=>x("/api/v1/tenants"),staleTime:3e5,refetchOnWindowFocus:!1}),_=null==k||null==(e=k[0])?void 0:e.id,{data:A,isLoading:C,refetch:P,isFetching:S}=(0,n.I)({queryKey:["events",_,s,g,f],queryFn:()=>{let e=new URLSearchParams({limit:"20",offset:(20*g).toString()});return f&&e.set("eventName",f),x("/api/v1/tenants/".concat(_,"/projects/").concat(s,"/events?").concat(e))},enabled:!!_,refetchInterval:3e4,staleTime:1e4,refetchOnWindowFocus:!1}),L=A?Math.ceil(A.total/20):0,E=null==A||null==(t=A.events)?void 0:t.filter(e=>{var t,s,a;if(!y)return!0;let i=y.toLowerCase();return e.event_name.toLowerCase().includes(i)||(null==(t=e.url)?void 0:t.toLowerCase().includes(i))||(null==(s=e.user_id)?void 0:s.toLowerCase().includes(i))||(null==(a=e.anonymous_id)?void 0:a.toLowerCase().includes(i))});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(p(),{href:"/projects/".concat(s),className:"p-2 hover:bg-white/10 rounded-md transition-colors",children:(0,a.jsx)(l.A,{className:"h-5 w-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold tracking-tight text-white",children:"Eventos"}),(0,a.jsx)("p",{className:"text-white/60",children:"Visualize eventos em tempo real"})]})]}),(0,a.jsxs)("button",{onClick:()=>P(),disabled:S,className:"inline-flex items-center justify-center rounded-md border border-white/20 px-4 py-2 text-sm font-medium text-white hover:bg-white/10 disabled:opacity-50",children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4 ".concat(S?"animate-spin":"")}),"Atualizar"]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(d.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-white/60"}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar por URL, user_id, anonymous_id...",value:y,onChange:e=>N(e.target.value),className:"flex h-10 w-full rounded-md border border-white/20 bg-white/5 pl-10 pr-3 py-2 text-sm text-white placeholder:text-white/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-white/60"}),(0,a.jsxs)("select",{value:f,onChange:e=>{j(e.target.value),b(0)},className:"flex h-10 w-full sm:w-48 rounded-md border border-white/20 bg-white/5 pl-10 pr-3 py-2 text-sm text-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",children:[(0,a.jsx)("option",{value:"",children:"Todos os eventos"}),(0,a.jsx)("option",{value:"page_view",children:"Page View"}),(0,a.jsx)("option",{value:"purchase",children:"Purchase"}),(0,a.jsx)("option",{value:"lead",children:"Lead"}),(0,a.jsx)("option",{value:"add_to_cart",children:"Add to Cart"}),(0,a.jsx)("option",{value:"view_content",children:"View Content"}),(0,a.jsx)("option",{value:"initiate_checkout",children:"Initiate Checkout"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,a.jsxs)("div",{className:"rounded-lg border border-white/10 bg-transparent p-4",children:[(0,a.jsx)("p",{className:"text-sm text-white/60",children:"Total de Eventos"}),(0,a.jsx)("p",{className:"mt-1 text-2xl font-semibold text-white",children:(null==A?void 0:A.total.toLocaleString("pt-BR"))||0})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-white/10 bg-transparent p-4",children:[(0,a.jsx)("p",{className:"text-sm text-white/60",children:"Exibindo"}),(0,a.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-white",children:[(null==E?void 0:E.length)||0," eventos"]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-white/10 bg-transparent p-4",children:[(0,a.jsx)("p",{className:"text-sm text-white/60",children:"P\xe1gina"}),(0,a.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-white",children:[g+1," de ",L||1]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-white/10 bg-transparent",children:[C?(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)(o.A,{className:"h-8 w-8 animate-spin text-white/60"}),(0,a.jsx)("p",{className:"mt-4 text-sm text-white/60",children:"Carregando eventos..."})]}):(null==E?void 0:E.length)===0?(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center text-center",children:[(0,a.jsx)(u.A,{className:"h-12 w-12 text-white/30"}),(0,a.jsx)("h3",{className:"mt-4 font-semibold text-white",children:"Nenhum evento encontrado"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-white/60",children:f||y?"Tente ajustar os filtros":"Eventos aparecer\xe3o aqui quando come\xe7arem a ser recebidos"})]}):(0,a.jsx)("div",{className:"divide-y divide-white/10",children:null==E?void 0:E.map(e=>(0,a.jsx)("div",{className:"p-4 hover:bg-white/5 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("span",{className:"inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ".concat(w[e.event_name]||"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300"),children:e.event_name}),e.value>0&&(0,a.jsxs)("span",{className:"text-sm font-medium text-green-400",children:[e.currency," ",e.value.toFixed(2)]})]}),e.url&&(0,a.jsx)("p",{className:"mt-2 text-sm text-white/60 truncate",children:e.path||e.url}),(0,a.jsxs)("div",{className:"mt-2 flex flex-wrap gap-x-4 gap-y-1 text-xs text-white/50",children:[e.anonymous_id&&(0,a.jsxs)("span",{children:["ID: ",e.anonymous_id.slice(0,8),"..."]}),e.user_id&&(0,a.jsxs)("span",{children:["User: ",e.user_id]}),e.utm_source&&(0,a.jsxs)("span",{children:["UTM: ",e.utm_source,e.utm_medium&&"/".concat(e.utm_medium)]}),e.country&&(0,a.jsx)("span",{children:e.country})]})]}),(0,a.jsxs)("div",{className:"text-right text-xs text-white/50 whitespace-nowrap",children:[(0,a.jsx)("p",{children:new Date(1e3*e.event_time).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),e.ip&&(0,a.jsx)("p",{className:"mt-1",children:e.ip})]})]})},e.event_id))}),L>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between border-t border-white/10 p-4",children:[(0,a.jsxs)("button",{onClick:()=>b(e=>Math.max(0,e-1)),disabled:0===g,className:"inline-flex items-center justify-center rounded-md border border-white/20 px-3 py-2 text-sm font-medium text-white hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)(h.A,{className:"mr-1 h-4 w-4"}),"Anterior"]}),(0,a.jsxs)("span",{className:"text-sm text-white/60",children:["P\xe1gina ",g+1," de ",L]}),(0,a.jsxs)("button",{onClick:()=>b(e=>Math.min(L-1,e+1)),disabled:g>=L-1,className:"inline-flex items-center justify-center rounded-md border border-white/20 px-3 py-2 text-sm font-medium text-white hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed",children:["Pr\xf3xima",(0,a.jsx)(m.A,{className:"ml-1 h-4 w-4"})]})]})]})]})}},4844:(e,t,s)=>{"use strict";var a=s(5340);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},8061:(e,t,s)=>{"use strict";s.d(t,{g:()=>r});var a=s(3603);let i="trackpro_auth";function r(){let e=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=function(){let e=localStorage.getItem(i);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(),a={"Content-Type":"application/json",...t.headers};s&&(a.Authorization="Bearer ".concat(s.accessToken));let r=await fetch("".concat("http://localhost:3001").concat(e),{...t,headers:a});if(!r.ok){let e=await r.json().catch(()=>({}));throw 401===r.status&&(localStorage.removeItem(i),window.location.pathname.includes("/login")||(window.location.href="/login")),Error(e.message||"Request failed: ".concat(r.status))}return 204===r.status?{}:r.json()},[]),t=(0,a.useCallback)(t=>e(t,{method:"GET"}),[e]),s=(0,a.useCallback)((t,s)=>e(t,{method:"POST",body:s?JSON.stringify(s):void 0}),[e]),r=(0,a.useCallback)((t,s)=>e(t,{method:"PUT",body:s?JSON.stringify(s):void 0}),[e]),n=(0,a.useCallback)((t,s)=>e(t,{method:"DELETE",body:s?JSON.stringify(s):void 0}),[e]);return{request:e,get:t,post:s,put:r,del:n}}},8743:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9374:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},9418:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[5803,2198,528,6438,2453,7358],()=>e(e.s=507)),_N_E=e.O()}]);