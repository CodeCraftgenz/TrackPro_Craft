(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2805],{2960:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var a=s(8307),l=s(3603),i=s(4844),r=s(5384),d=s(5803),n=s.n(d),c=s(7778),o=s(7154),h=s(3686),x=s(8327),m=s(8743),u=s(9418),p=s(4646),b=s(8061);let j={FACEBOOK:c.A,INSTAGRAM:o.A,TWITTER:h.A,WEBSITE:x.A},w={FACEBOOK:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",INSTAGRAM:"bg-pink-100 text-pink-700 dark:bg-pink-900/30 dark:text-pink-400",TWITTER:"bg-sky-100 text-sky-700 dark:bg-sky-900/30 dark:text-sky-400",WEBSITE:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"};function f(){var e,t,s;let d=(0,i.useParams)().id,{get:c}=(0,b.g)(),[o,f]=(0,l.useState)({startDate:new Date(Date.now()-2592e6).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[y,v]=(0,l.useState)("all"),{data:g}=(0,r.I)({queryKey:["tenants"],queryFn:()=>c("/api/v1/tenants")}),N=null==g||null==(e=g[0])?void 0:e.id,{data:k,isLoading:A,refetch:T}=(0,r.I)({queryKey:["lead-stats",N,d,o],queryFn:()=>c("/api/v1/tenants/".concat(N,"/projects/").concat(d,"/leads/stats?startDate=").concat(o.startDate,"&endDate=").concat(o.endDate)),enabled:!!N}),{data:D,isLoading:S}=(0,r.I)({queryKey:["leads",N,d,o,y],queryFn:()=>c("/api/v1/tenants/".concat(N,"/projects/").concat(d,"/leads?startDate=").concat(o.startDate,"&endDate=").concat(o.endDate).concat("all"!==y?"&platform=".concat(y):"","&limit=100")),enabled:!!N});if(A||S)return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"h-8 w-48 animate-pulse rounded bg-white/10"}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-24 animate-pulse rounded-lg bg-white/10"},t))}),(0,a.jsx)("div",{className:"h-64 animate-pulse rounded-lg bg-white/10"})]});let E=(null==k?void 0:k.total)||0,I=(null==k?void 0:k.byPlatform)||{},M=(null==k?void 0:k.byDay)||[];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(n(),{href:"/projects/".concat(d,"/leads"),className:"p-2 hover:bg-white/10 rounded-md transition-colors",children:(0,a.jsx)(m.A,{className:"h-5 w-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold tracking-tight text-white",children:"Relat\xf3rios de Leads"}),(0,a.jsx)("p",{className:"text-white/60",children:"Visualize e analise os leads capturados"})]})]}),(0,a.jsxs)("button",{onClick:()=>T(),className:"inline-flex items-center justify-center rounded-md border border-white/20 px-3 py-2 text-sm font-medium text-white hover:bg-white/10",children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Atualizar"]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-white",children:"Data inicial"}),(0,a.jsx)("input",{type:"date",value:o.startDate,onChange:e=>f({...o,startDate:e.target.value}),className:"mt-1 flex h-10 rounded-md border border-white/20 bg-white/5 px-3 py-2 text-sm text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-white",children:"Data final"}),(0,a.jsx)("input",{type:"date",value:o.endDate,onChange:e=>f({...o,endDate:e.target.value}),className:"mt-1 flex h-10 rounded-md border border-white/20 bg-white/5 px-3 py-2 text-sm text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-white",children:"Plataforma"}),(0,a.jsxs)("select",{value:y,onChange:e=>v(e.target.value),className:"mt-1 flex h-10 rounded-md border border-white/20 bg-white/5 px-3 py-2 text-sm text-white",children:[(0,a.jsx)("option",{value:"all",children:"Todas"}),(0,a.jsx)("option",{value:"FACEBOOK",children:"Facebook"}),(0,a.jsx)("option",{value:"INSTAGRAM",children:"Instagram"}),(0,a.jsx)("option",{value:"TWITTER",children:"Twitter"}),(0,a.jsx)("option",{value:"WEBSITE",children:"Website"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)("div",{className:"rounded-lg border border-white/10 bg-transparent p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-white/60",children:"Total de Leads"}),(0,a.jsx)(h.A,{className:"h-5 w-5 text-white/60"})]}),(0,a.jsx)("p",{className:"mt-2 text-3xl font-bold text-white",children:E}),(0,a.jsx)("p",{className:"text-xs text-white/50",children:"No per\xedodo selecionado"})]}),Object.entries(I).map(e=>{let[t,s]=e,l=j[t]||x.A;return(0,a.jsxs)("div",{className:"rounded-lg border border-white/10 bg-transparent p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-white/60",children:t}),(0,a.jsx)(l,{className:"h-5 w-5 text-white/60"})]}),(0,a.jsx)("p",{className:"mt-2 text-3xl font-bold text-white",children:s}),(0,a.jsxs)("p",{className:"text-xs text-white/50",children:[E>0?(s/E*100).toFixed(1):0,"% do total"]})]},t)})]}),M.length>0&&(0,a.jsxs)("div",{className:"rounded-lg border border-white/10 bg-transparent",children:[(0,a.jsx)("div",{className:"border-b border-white/10 p-4",children:(0,a.jsx)("h2",{className:"font-semibold text-white",children:"Leads por Dia"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("div",{className:"flex items-end justify-between h-48 gap-1",children:M.slice(-30).map(e=>{let t=Math.max(...M.map(e=>e.count),1),s=e.count/t*100;return(0,a.jsx)("div",{className:"flex-1 flex flex-col items-center group",children:(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("div",{className:"w-full bg-primary/80 rounded-t transition-all hover:bg-primary",style:{height:"".concat(Math.max(s,2),"%")},title:"".concat(e.date,": ").concat(e.count," leads")}),(0,a.jsx)("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 text-xs bg-[#1a1a2e] text-white px-2 py-1 rounded shadow",children:e.count})]})},e.date)})}),(0,a.jsxs)("div",{className:"flex justify-between mt-2 text-xs text-white/50",children:[(0,a.jsx)("span",{children:null==(t=M[0])?void 0:t.date}),(0,a.jsx)("span",{children:null==(s=M[M.length-1])?void 0:s.date})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-white/10 bg-transparent",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-white/10 p-4",children:[(0,a.jsx)("h2",{className:"font-semibold text-white",children:"Leads Recentes"}),(0,a.jsxs)("button",{className:"inline-flex items-center justify-center rounded-md border border-white/20 px-3 py-1.5 text-sm font-medium text-white hover:bg-white/10",children:[(0,a.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Exportar CSV"]})]}),(null==D?void 0:D.leads)&&D.leads.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-white/10 bg-white/5",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-white/60",children:"Data"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-white/60",children:"Nome"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-white/60",children:"E-mail"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-white/60",children:"Telefone"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-white/60",children:"Plataforma"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-white/60",children:"Fonte"})]})}),(0,a.jsx)("tbody",{children:D.leads.map(e=>(0,a.jsxs)("tr",{className:"border-b border-white/10 hover:bg-white/5",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-white",children:new Date(e.created_at).toLocaleString("pt-BR")}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm font-medium text-white",children:e.name||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-white/80",children:e.email||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-white/80",children:e.phone||"-"}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ".concat(w[e.platform]||"bg-white/10 text-white/70"),children:e.platform})}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-white/50",children:e.utm_source||e.referrer||"-"})]},e.lead_id))})]})}):(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)(h.A,{className:"mx-auto h-12 w-12 text-white/30"}),(0,a.jsx)("h3",{className:"mt-4 font-semibold text-white",children:"Nenhum lead encontrado"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-white/60",children:"N\xe3o h\xe1 leads no per\xedodo selecionado com os filtros aplicados."})]})]})]})}},3686:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},4034:(e,t,s)=>{Promise.resolve().then(s.bind(s,2960))},4646:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},4844:(e,t,s)=>{"use strict";var a=s(5340);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},7154:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]])},7778:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]])},8061:(e,t,s)=>{"use strict";s.d(t,{g:()=>i});var a=s(3603);let l="trackpro_auth";function i(){let e=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=function(){let e=localStorage.getItem(l);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(),a={"Content-Type":"application/json",...t.headers};s&&(a.Authorization="Bearer ".concat(s.accessToken));let i=await fetch("".concat("http://localhost:3001").concat(e),{...t,headers:a});if(!i.ok){let e=await i.json().catch(()=>({}));throw 401===i.status&&(localStorage.removeItem(l),window.location.pathname.includes("/login")||(window.location.href="/login")),Error(e.message||"Request failed: ".concat(i.status))}return 204===i.status?{}:i.json()},[]),t=(0,a.useCallback)(t=>e(t,{method:"GET"}),[e]),s=(0,a.useCallback)((t,s)=>e(t,{method:"POST",body:s?JSON.stringify(s):void 0}),[e]),i=(0,a.useCallback)((t,s)=>e(t,{method:"PUT",body:s?JSON.stringify(s):void 0}),[e]),r=(0,a.useCallback)((t,s)=>e(t,{method:"DELETE",body:s?JSON.stringify(s):void 0}),[e]);return{request:e,get:t,post:s,put:i,del:r}}},8327:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},8743:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9418:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[5803,2198,528,6438,2453,7358],()=>e(e.s=4034)),_N_E=e.O()}]);