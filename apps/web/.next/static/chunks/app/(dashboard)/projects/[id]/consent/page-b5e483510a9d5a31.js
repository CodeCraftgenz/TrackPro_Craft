(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1580],{4714:(e,s,t)=>{Promise.resolve().then(t.bind(t,7674))},7674:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>S});var a=t(8307),n=t(3603),i=t(4844),l=t(997),r=t(5384),o=t(328),d=t(8743),c=t(7911),m=t(760),u=t(2151),x=t(4520),h=t(3686),g=t(4427),b=t(2330),p=t(9418),f=t(1246),j=t(6510),v=t(3933),N=t(9374),y=t(5381),k=t(6632),w=t(5803),C=t.n(w),A=t(8061);let P={sdk:"SDK",api:"API",manual:"Manual"};function S(){var e;let s=(0,i.useParams)().id,{get:t,put:w}=(0,A.g)(),S=(0,l.jE)(),[q,E]=(0,n.useState)("overview"),[I,L]=(0,n.useState)(0),[T,B]=(0,n.useState)(""),{data:D}=(0,r.I)({queryKey:["tenants"],queryFn:()=>t("/api/v1/tenants")}),z=null==D||null==(e=D[0])?void 0:e.id,{data:R,isLoading:U}=(0,r.I)({queryKey:["consent-stats",z,s],queryFn:()=>t("/api/v1/tenants/".concat(z,"/projects/").concat(s,"/consent/stats")),enabled:!!z}),{data:O,isLoading:K}=(0,r.I)({queryKey:["consent-settings",z,s],queryFn:()=>t("/api/v1/tenants/".concat(z,"/projects/").concat(s,"/consent/settings")),enabled:!!z}),{data:M,isLoading:F,refetch:_,isFetching:G}=(0,r.I)({queryKey:["consent-logs",z,s,I,T],queryFn:()=>{let e=new URLSearchParams({limit:"20",offset:(20*I).toString()});return T&&e.set("anonymousId",T),t("/api/v1/tenants/".concat(z,"/projects/").concat(s,"/consent/logs?").concat(e))},enabled:!!z&&"logs"===q}),J=(0,o.n)({mutationFn:e=>w("/api/v1/tenants/".concat(z,"/projects/").concat(s,"/consent/settings"),e),onSuccess:()=>{S.invalidateQueries({queryKey:["consent-settings",z,s]})}}),V=M?Math.ceil(M.total/20):0,H={analytics:{enabled:!0,description:"Cookies de an\xe1lise"},marketing:{enabled:!0,description:"Cookies de marketing"},personalization:{enabled:!0,description:"Cookies de personaliza\xe7\xe3o"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(C(),{href:"/projects/".concat(s),className:"p-2 hover:bg-accent rounded-md transition-colors",children:(0,a.jsx)(d.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:"Gest\xe3o de Consentimento"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"LGPD - Controle e hist\xf3rico de consentimentos"})]})]})}),(0,a.jsx)("div",{className:"border-b",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Vis\xe3o Geral",icon:c.A},{id:"logs",label:"Hist\xf3rico",icon:m.A},{id:"settings",label:"Configura\xe7\xf5es",icon:u.A}].map(e=>(0,a.jsxs)("button",{onClick:()=>E(e.id),className:"flex items-center gap-2 border-b-2 px-1 py-4 text-sm font-medium transition-colors ".concat(q===e.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:border-muted-foreground/30 hover:text-foreground"),children:[(0,a.jsx)(e.icon,{className:"h-4 w-4"}),e.label]},e.id))})}),"overview"===q&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total de Consentimentos"})]}),(0,a.jsx)("p",{className:"mt-2 text-2xl font-semibold",children:U?"...":(null==R?void 0:R.total.toLocaleString("pt-BR"))||0})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 text-blue-500"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Usu\xe1rios \xdanicos"})]}),(0,a.jsx)("p",{className:"mt-2 text-2xl font-semibold",children:U?"...":(null==R?void 0:R.uniqueUsers.toLocaleString("pt-BR"))||0})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-green-500"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"\xdaltimos 30 dias"})]}),(0,a.jsx)("p",{className:"mt-2 text-2xl font-semibold",children:U?"...":(null==R?void 0:R.last30Days.toLocaleString("pt-BR"))||0})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-yellow-500"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"\xdaltimos 7 dias"})]}),(0,a.jsx)("p",{className:"mt-2 text-2xl font-semibold",children:U?"...":(null==R?void 0:R.last7Days.toLocaleString("pt-BR"))||0})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Taxa de Aceita\xe7\xe3o por Categoria"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Baseado nos \xfaltimos 100 consentimentos registrados"}),(0,a.jsx)("div",{className:"mt-6 space-y-4",children:[{key:"analytics",label:"Analytics",color:"bg-blue-500",description:"Cookies de an\xe1lise e m\xe9tricas"},{key:"marketing",label:"Marketing",color:"bg-purple-500",description:"Cookies de publicidade e remarketing"},{key:"personalization",label:"Personaliza\xe7\xe3o",color:"bg-green-500",description:"Prefer\xeancias e experi\xeancia personalizada"}].map(e=>{let s=(null==R?void 0:R.acceptanceRates[e.key])||0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.label}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]}),(0,a.jsxs)("span",{className:"text-lg font-semibold",children:[s,"%"]})]}),(0,a.jsx)("div",{className:"mt-2 h-2 w-full rounded-full bg-muted",children:(0,a.jsx)("div",{className:"h-2 rounded-full ".concat(e.color," transition-all"),style:{width:"".concat(s,"%")}})})]},e.key)})})]}),(0,a.jsx)("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-900 dark:bg-blue-950",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Conformidade LGPD"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-blue-800 dark:text-blue-200",children:"Todos os consentimentos s\xe3o registrados com timestamp, hash de IP e fonte de origem. Os dados s\xe3o mantidos conforme a pol\xedtica de reten\xe7\xe3o do projeto para fins de auditoria."})]})]})})]}),"logs"===q&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(b.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar por Anonymous ID...",value:T,onChange:e=>{B(e.target.value),L(0)},className:"flex h-10 w-full rounded-md border border-input bg-background pl-10 pr-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"})]}),(0,a.jsxs)("button",{onClick:()=>_(),disabled:G,className:"inline-flex items-center justify-center rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent disabled:opacity-50",children:[(0,a.jsx)(p.A,{className:"mr-2 h-4 w-4 ".concat(G?"animate-spin":"")}),"Atualizar"]})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card",children:[F?(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)(p.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"Carregando hist\xf3rico..."})]}):M&&0!==M.logs.length?(0,a.jsx)("div",{className:"divide-y",children:M.logs.map(e=>(0,a.jsx)("div",{className:"p-4 hover:bg-accent/50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-mono text-sm truncate",children:e.anonymousId}),(0,a.jsx)("span",{className:"inline-flex items-center rounded-full bg-muted px-2 py-0.5 text-xs font-medium",children:P[e.source]})]}),(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:Object.entries(e.categories).map(e=>{let[s,t]=e;return(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ".concat(t?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"),children:[t?(0,a.jsx)(f.A,{className:"h-3 w-3"}):(0,a.jsx)(j.A,{className:"h-3 w-3"}),s.charAt(0).toUpperCase()+s.slice(1)]},s)})})]}),(0,a.jsx)("div",{className:"text-right text-xs text-muted-foreground whitespace-nowrap",children:(0,a.jsx)("p",{children:new Date(e.createdAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})})]})},e.id))}):(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center text-center",children:[(0,a.jsx)(x.A,{className:"h-12 w-12 text-muted-foreground/50"}),(0,a.jsx)("h3",{className:"mt-4 font-semibold",children:"Nenhum registro encontrado"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:T?"Tente buscar por outro ID":"Registros de consentimento aparecer\xe3o aqui"})]}),V>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between border-t p-4",children:[(0,a.jsxs)("button",{onClick:()=>L(e=>Math.max(0,e-1)),disabled:0===I,className:"inline-flex items-center justify-center rounded-md border px-3 py-2 text-sm font-medium hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)(v.A,{className:"mr-1 h-4 w-4"}),"Anterior"]}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["P\xe1gina ",I+1," de ",V]}),(0,a.jsxs)("button",{onClick:()=>L(e=>Math.min(V-1,e+1)),disabled:I>=V-1,className:"inline-flex items-center justify-center rounded-md border px-3 py-2 text-sm font-medium hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:["Pr\xf3xima",(0,a.jsx)(N.A,{className:"ml-1 h-4 w-4"})]})]})]})]}),"settings"===q&&(0,a.jsx)("div",{className:"space-y-6",children:K?(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)(p.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"Carregando configura\xe7\xf5es..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Banner de Consentimento"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure como o banner de cookies aparece no seu site"}),(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Exibir Banner"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Mostrar o banner de consentimento para novos visitantes"})]}),(0,a.jsx)("button",{onClick:()=>J.mutate({bannerEnabled:!(null==O?void 0:O.bannerEnabled)}),disabled:J.isPending,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors ".concat((null==O?void 0:O.bannerEnabled)?"bg-primary":"bg-muted"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat((null==O?void 0:O.bannerEnabled)?"translate-x-6":"translate-x-1")})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Posi\xe7\xe3o do Banner"}),(0,a.jsxs)("select",{value:(null==O?void 0:O.bannerPosition)||"bottom",onChange:e=>J.mutate({bannerPosition:e.target.value}),className:"mt-1 flex h-10 w-full max-w-xs rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",children:[(0,a.jsx)("option",{value:"bottom",children:"Inferior"}),(0,a.jsx)("option",{value:"top",children:"Superior"}),(0,a.jsx)("option",{value:"center",children:"Central (Modal)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Tema do Banner"}),(0,a.jsxs)("select",{value:(null==O?void 0:O.bannerTheme)||"auto",onChange:e=>J.mutate({bannerTheme:e.target.value}),className:"mt-1 flex h-10 w-full max-w-xs rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",children:[(0,a.jsx)("option",{value:"auto",children:"Autom\xe1tico"}),(0,a.jsx)("option",{value:"light",children:"Claro"}),(0,a.jsx)("option",{value:"dark",children:"Escuro"})]})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Links de Pol\xedticas"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"URLs das suas p\xe1ginas de pol\xedticas de privacidade e cookies"}),(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Pol\xedtica de Privacidade"}),(0,a.jsx)("input",{type:"url",value:(null==O?void 0:O.privacyPolicyUrl)||"",onChange:e=>J.mutate({privacyPolicyUrl:e.target.value}),placeholder:"https://seusite.com/privacidade",className:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Pol\xedtica de Cookies"}),(0,a.jsx)("input",{type:"url",value:(null==O?void 0:O.cookiePolicyUrl)||"",onChange:e=>J.mutate({cookiePolicyUrl:e.target.value}),placeholder:"https://seusite.com/cookies",className:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Categorias de Consentimento"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure quais categorias de cookies s\xe3o exibidas"}),(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border bg-muted/50 p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Necess\xe1rios"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cookies essenciais para o funcionamento do site"})]}),(0,a.jsx)("span",{className:"text-xs font-medium text-muted-foreground",children:"Sempre ativo"})]}),[{key:"analytics",label:"Analytics",description:"Cookies de an\xe1lise e m\xe9tricas"},{key:"marketing",label:"Marketing",description:"Cookies de publicidade e remarketing"},{key:"personalization",label:"Personaliza\xe7\xe3o",description:"Prefer\xeancias e experi\xeancia personalizada"}].map(e=>{var s,t,n;let i=null==(n=null==O||null==(t=O.categoriesConfig)||null==(s=t[e.key])?void 0:s.enabled)||n;return(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.label}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,a.jsx)("button",{onClick:()=>{var s;let t=null!=(s=null==O?void 0:O.categoriesConfig)?s:H,a=e.key;J.mutate({categoriesConfig:{...t,[a]:{...t[a],enabled:!i}}})},disabled:J.isPending,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors ".concat(i?"bg-primary":"bg-muted"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(i?"translate-x-6":"translate-x-1")})})]},e.key)})]})]}),(0,a.jsx)("div",{className:"rounded-lg border border-yellow-200 bg-yellow-50 p-4 dark:border-yellow-900 dark:bg-yellow-950",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(y.A,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-yellow-900 dark:text-yellow-100",children:"Integra\xe7\xe3o com SDK"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-yellow-800 dark:text-yellow-200",children:"Para que o banner funcione, certifique-se de que o SDK TrackPro est\xe1 instalado no seu site com a op\xe7\xe3o de consentimento habilitada."}),(0,a.jsxs)("a",{href:"#",className:"mt-2 inline-flex items-center gap-1 text-sm font-medium text-yellow-700 hover:text-yellow-900 dark:text-yellow-300 dark:hover:text-yellow-100",children:["Ver documenta\xe7\xe3o",(0,a.jsx)(k.A,{className:"h-3 w-3"})]})]})]})})]})})]})}},8061:(e,s,t)=>{"use strict";t.d(s,{g:()=>i});var a=t(3603);let n="trackpro_auth";function i(){let e=(0,a.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=function(){let e=localStorage.getItem(n);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(),a={"Content-Type":"application/json",...s.headers};t&&(a.Authorization="Bearer ".concat(t.accessToken));let i=await fetch("".concat("http://localhost:3001").concat(e),{...s,headers:a});if(!i.ok){let e=await i.json().catch(()=>({}));throw 401===i.status&&(localStorage.removeItem(n),window.location.pathname.includes("/login")||(window.location.href="/login")),Error(e.message||"Request failed: ".concat(i.status))}return 204===i.status?{}:i.json()},[]),s=(0,a.useCallback)(s=>e(s,{method:"GET"}),[e]),t=(0,a.useCallback)((s,t)=>e(s,{method:"POST",body:t?JSON.stringify(t):void 0}),[e]),i=(0,a.useCallback)((s,t)=>e(s,{method:"PUT",body:t?JSON.stringify(t):void 0}),[e]),l=(0,a.useCallback)((s,t)=>e(s,{method:"DELETE",body:t?JSON.stringify(t):void 0}),[e]);return{request:e,get:s,post:t,put:i,del:l}}}},e=>{e.O(0,[5803,2198,528,19,6438,2453,7358],()=>e(e.s=4714)),_N_E=e.O()}]);