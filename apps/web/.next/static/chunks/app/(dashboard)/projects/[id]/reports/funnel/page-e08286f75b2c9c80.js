(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8098],{90:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var a=s(8307),r=s(3603),n=s(4844),c=s(5384),l=s(8743),d=s(9418),i=s(7911),o=s(1319),m=s(4427),u=s(287),x=s(3947),p=s(9019);let h=(0,s(3161).A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var f=s(5803),g=s.n(f),j=s(8061);let y={page_view:"Visualiza\xe7\xe3o",view_content:"Viu Conte\xfado",add_to_cart:"Add ao Carrinho",initiate_checkout:"Iniciou Checkout",purchase:"Compra",lead:"Lead",search:"Pesquisa"};function v(){var e,t,s;let f=(0,n.useParams)().id,{get:v}=(0,j.g)(),[b,N]=(0,r.useState)(()=>{let e=new Date;return e.setDate(e.getDate()-30),e.toISOString().split("T")[0]}),[k,w]=(0,r.useState)(()=>new Date().toISOString().split("T")[0]),[A,C]=(0,r.useState)(["page_view","view_content","add_to_cart","initiate_checkout","purchase"]),{data:S}=(0,c.I)({queryKey:["tenants"],queryFn:()=>v("/api/v1/tenants")}),M=null==S||null==(e=S[0])?void 0:e.id,{data:_,isLoading:P,refetch:L,isFetching:O}=(0,c.I)({queryKey:["funnel-report",M,f,b,k,A],queryFn:()=>v("/api/v1/tenants/".concat(M,"/projects/").concat(f,"/reports/funnel?startDate=").concat(b,"&endDate=").concat(k,"&steps=").concat(A.join(","))),enabled:!!M}),R=Math.max(...(null==_||null==(t=_.steps)?void 0:t.map(e=>e.count))||[1]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(g(),{href:"/projects/".concat(f),className:"p-2 hover:bg-accent rounded-md transition-colors",children:(0,a.jsx)(l.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:"Funil de Convers\xe3o"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"An\xe1lise do funil de convers\xe3o do seu projeto"})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("button",{onClick:()=>L(),disabled:O,className:"inline-flex items-center justify-center rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent disabled:opacity-50",children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4 ".concat(O?"animate-spin":"")}),"Atualizar"]})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(g(),{href:"/projects/".concat(f,"/reports"),className:"inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),"Vis\xe3o Geral"]}),(0,a.jsxs)(g(),{href:"/projects/".concat(f,"/reports/funnel"),className:"inline-flex items-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),"Funil"]}),(0,a.jsxs)(g(),{href:"/projects/".concat(f,"/reports/performance"),className:"inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent",children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),"Performance"]}),(0,a.jsxs)(g(),{href:"/projects/".concat(f,"/reports/quality"),className:"inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-medium hover:bg-accent",children:[(0,a.jsx)(u.A,{className:"h-4 w-4"}),"Qualidade"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 rounded-lg border bg-card p-4",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"date",value:b,onChange:e=>N(e.target.value),className:"h-9 rounded-md border border-input bg-background px-3 py-1 text-sm"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"at\xe9"}),(0,a.jsx)("input",{type:"date",value:k,onChange:e=>w(e.target.value),className:"h-9 rounded-md border border-input bg-background px-3 py-1 text-sm"})]})]}),P?(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)(d.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"Carregando funil..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Iniciaram"}),(0,a.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)("p",{className:"mt-2 text-2xl font-semibold",children:((null==_?void 0:_.totalStarted)||0).toLocaleString("pt-BR")})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Converteram"}),(0,a.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)("p",{className:"mt-2 text-2xl font-semibold text-green-600",children:((null==_?void 0:_.totalCompleted)||0).toLocaleString("pt-BR")})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Taxa de Convers\xe3o"}),(0,a.jsx)(m.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)("p",{className:"mt-2 text-2xl font-semibold text-primary",children:[(null==_?void 0:_.conversionRate)||0,"%"]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,a.jsx)("h3",{className:"font-semibold mb-6",children:"Funil de Convers\xe3o"}),(0,a.jsx)("div",{className:"space-y-4",children:null==_||null==(s=_.steps)?void 0:s.map((e,t)=>{var s;let r=Math.max(e.count/R*100,10),n=t===((null==_||null==(s=_.steps)?void 0:s.length)||0)-1;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded-full bg-primary/10 text-primary text-xs font-medium flex items-center justify-center",children:t+1}),(0,a.jsx)("span",{className:"font-medium",children:y[e.name]||e.name})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.count.toLocaleString("pt-BR")," usu\xe1rios"]}),(0,a.jsxs)("span",{className:"px-2 py-0.5 rounded ".concat(e.percentage>=50?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":e.percentage>=20?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"),children:[e.percentage,"%"]})]})]}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"h-10 bg-primary/80 rounded-md transition-all flex items-center justify-end pr-4",style:{width:"".concat(r,"%")},children:(0,a.jsx)("span",{className:"text-xs text-primary-foreground font-medium",children:e.count.toLocaleString("pt-BR")})})}),!n&&e.dropoff>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2 ml-8 text-sm text-muted-foreground",children:[(0,a.jsx)(h,{className:"h-3 w-3 text-red-500"}),(0,a.jsxs)("span",{className:"text-red-600 dark:text-red-400",children:["-",e.dropoff.toLocaleString("pt-BR")," abandonaram"]})]})]},e.name)})})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Configurar Etapas do Funil"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Selecione os eventos que comp\xf5em o funil de convers\xe3o"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(y).map(e=>{let[t,s]=e,r=A.includes(t),n=A.indexOf(t);return(0,a.jsxs)("button",{onClick:()=>{r?C(A.filter(e=>e!==t)):C([...A,t])},className:"inline-flex items-center gap-2 rounded-md px-3 py-2 text-sm font-medium transition-colors ".concat(r?"bg-primary text-primary-foreground":"border hover:bg-accent"),children:[r&&(0,a.jsx)("span",{className:"w-4 h-4 rounded-full bg-primary-foreground/20 text-xs flex items-center justify-center",children:n+1}),s]},t)})})]})]})]})}},287:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1319:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},3947:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},4427:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},4844:(e,t,s)=>{"use strict";var a=s(5340);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},6673:(e,t,s)=>{Promise.resolve().then(s.bind(s,90))},7911:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},8061:(e,t,s)=>{"use strict";s.d(t,{g:()=>n});var a=s(3603);let r="trackpro_auth";function n(){let e=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=function(){let e=localStorage.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(),a={"Content-Type":"application/json",...t.headers};s&&(a.Authorization="Bearer ".concat(s.accessToken));let n=await fetch("".concat("http://localhost:3001").concat(e),{...t,headers:a});if(!n.ok){let e=await n.json().catch(()=>({}));throw 401===n.status&&(localStorage.removeItem(r),window.location.pathname.includes("/login")||(window.location.href="/login")),Error(e.message||"Request failed: ".concat(n.status))}return 204===n.status?{}:n.json()},[]),t=(0,a.useCallback)(t=>e(t,{method:"GET"}),[e]),s=(0,a.useCallback)((t,s)=>e(t,{method:"POST",body:s?JSON.stringify(s):void 0}),[e]),n=(0,a.useCallback)((t,s)=>e(t,{method:"PUT",body:s?JSON.stringify(s):void 0}),[e]),c=(0,a.useCallback)((t,s)=>e(t,{method:"DELETE",body:s?JSON.stringify(s):void 0}),[e]);return{request:e,get:t,post:s,put:n,del:c}}},8743:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9019:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},9418:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3161).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[5803,2198,528,6438,2453,7358],()=>e(e.s=6673)),_N_E=e.O()}]);